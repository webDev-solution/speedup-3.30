/*
Generated time: October 16, 2023 12:43
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
document.addEventListener("alpine:init",()=>{Alpine.data("ThemeModule_CartItems",()=>({itemsRoot:null,locked:null,init(){this.itemsRoot=this.$root,window.addEventListener("shapes:modalcart:afteradditem",t=>{Alpine.morph(this.itemsRoot,querySelectorInHTMLString("[data-cart-items]",t.detail.response.sections["cart-items"]).outerHTML)}),window.addEventListener("shapes:modalcart:cartqtychange",t=>{Alpine.morph(this.itemsRoot,querySelectorInHTMLString("[data-cart-items]",t.detail.response.sections["cart-items"]).outerHTML),this.$nextTick(()=>{this.itemsRoot.querySelectorAll("input").forEach(t=>{t.value=t.getAttribute("value")})});var e=parseDOMFromString(t.detail.response.sections["cart-live-region"]).firstElementChild.textContent,i=document.getElementById("cart-live-region-text");i.textContent=e,i.setAttribute("aria-hidden",!1),t.detail.originalTarget&&this.$nextTick(()=>{if(!this.itemsRoot.contains(t.detail.originalTarget)){let t;t=this.itemsRoot.closest('[role="dialog"]')?this.itemsRoot.closest('[role="dialog"]').parentNode:this.itemsRoot,this.$focus.within(t).first()}})})},itemQuantityChange(t,e){if(!this.locked){const s=this.$el.closest("li[data-cart-item-key]");var t=t||s.getAttribute("data-cart-item-key"),e=parseInt(isNaN(e)?this.$el.value:e,10),i=fetchConfigDefaults(),t=(i.body=JSON.stringify({id:t,quantity:e,sections:"cart-items,cart-footer,cart-item-count,cart-live-region",sections_url:window.location.pathname}),parseInt(this.$el.dataset.lastValue,10));if(e!==t){s.classList.add("opacity-50","cursor-progress");const a=Alpine.raw(Alpine.store("cart_count").count);this.locked=s,fetch(theme.routes.cart_change_url,i).then(t=>t.json()).then(t=>{var e;t.item_count===a?((e=s.querySelector("[data-cart-quantity-error]")).textContent=theme.strings.cartAddError.replace("{{ title }}",e.dataset.itemTitle),e.classList.remove("hidden")):document.body.dispatchEvent(new CustomEvent("shapes:modalcart:cartqtychange",{bubbles:!0,detail:{response:t,originalTarget:s}}))}).catch(()=>{document.getElementById("cart-errors").textContent=theme.strings.cartError}).finally(()=>{this.locked=null})}}},removeItem(t){this.itemQuantityChange(t,0)},_adjustQty(t,e){var t=t.closest("li[key]").querySelector('input[type="number"]'),i=parseInt(t.dataset.lastValue,10);let s;"increment"==e&&(s=i+1),"decrement"==e&&(s=1<i?i-1:1),"remove"==e&&(s=0),t.value=s,t.dispatchEvent(new Event("change",{bubbles:!0}))},increment(){this._adjustQty(this.$el,"increment")},decrement(){this._adjustQty(this.$el,"decrement")},remove(){this._adjustQty(this.$el,"remove")}}))});