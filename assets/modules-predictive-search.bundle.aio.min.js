/*
Generated time: October 16, 2023 12:43
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
import{r as removeTrapFocus,t as trapFocus}from"./shared-import-theme-a11y.bundle.js";window.ThemeComponent_PredictiveSearch=e=>({cachedResults:{},loading:!1,isOpen:!1,rawQuery:"",results:!1,resultsMarkup:null,resources:e,get trimmedQuery(){return this.rawQuery.trim()},mounted(){this.cachedResults={},document.querySelectorAll("[data-open-search]").forEach(e=>{e.setAttribute("role","button")}),document.addEventListener("keyup",e=>{"Escape"===e.key&&(this.close(!1,!0),setTimeout(()=>this.$refs.input.focus(),100))})},close(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=(this.isOpen=!1,e&&(this.rawQuery=""),this.$el.querySelector('[aria-selected="true"]'));e&&e.setAttribute("aria-selected",!1),this.$refs.input.setAttribute("aria-activedescendant",""),this.$refs.input.setAttribute("aria-expanded",!1),removeTrapFocus(),document.documentElement.style.overflowY="auto",t&&document.body.dispatchEvent(new CustomEvent("label:search:closebutton"));const s=document.querySelector("[data-open-search]");s&&setTimeout(()=>s.focus(),100)},getSearchResults(){this.loading=!0;const s=this.trimmedQuery.replace(" ","-").toLowerCase();liveRegion(window.theme.strings.loading),fetch(`${window.theme.routes.predictive_search_url}?q=${encodeURIComponent(this.trimmedQuery)}&${encodeURIComponent("resources[type]")}=${this.resources}&${encodeURIComponent("resources[limit]")}=10&section_id=predictive-search`).then(e=>{if(this.loading=!1,e.ok)return e.text();throw e=new Error(e.status),this.close(),e}).then(e=>{this.results=!0;var t=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-predictive-search").innerHTML,e=(new DOMParser).parseFromString(e,"text/html").querySelector("#predictive-search-count").textContent;this.cachedResults[s]=t,this.renderSearchResults(t),liveRegion(e)}).catch(e=>{throw this.close(),e})},onChange(){this.trimmedQuery.length?(this.open(),this.getSearchResults()):this.close(!0)},onFocus(){this.trimmedQuery.length&&(!0===this.results?this.open():this.getSearchResults())},onFocusOut(){setTimeout(()=>{this.$el.contains(document.activeElement)||this.close()})},onFormSubmit(e){this.trimmedQuery.length&&!this.$el.querySelector('[aria-selected="true"] a')||e.preventDefault()},onKeyup(e){switch(e.preventDefault(),e.code){case"ArrowUp":this.switchOption("up");break;case"ArrowDown":this.switchOption("down");break;case"Enter":this.selectOption()}},onKeydown(e){"ArrowUp"!==e.code&&"ArrowDown"!==e.code||e.preventDefault()},open(){this.isOpen=!0,this.$refs.input.setAttribute("aria-expanded",!0),document.documentElement.style.overflowY="hidden"},renderSearchResults(e){this.$refs.results.innerHTML=e,this.results=!0,this.open(),setTimeout(()=>{trapFocus(this.$el),this.$refs.input.focus()},300)},selectOption(){var e=this.$el.querySelector('[aria-selected="true"] a, [aria-selected="true"] button');e&&e.click()},switchOption(t){if(this.isOpen){var t="up"===t,s=this.$el.querySelector('[aria-selected="true"]'),r=this.$el.querySelectorAll("li");let e=this.$el.querySelector("li");t&&!s||(!t&&s?e=s.nextElementSibling||r[0]:t&&(e=s.previousElementSibling||r[r.length-1]),e!==s&&(e.setAttribute("aria-selected",!0),s&&s.setAttribute("aria-selected",!1),this.$refs.input.setAttribute("aria-activedescendant",e.id)))}}});